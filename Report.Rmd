---
title: Group 5 Midterm Project Report
author: Erika Canda, Shannon Cloherty, Alex Klimek, Tina Teng, Afia Tyus
output: html_document
params: 
  var_name: "weight1"
  var_cutoff: 10
---

```{r, here-i-am, include = FALSE}
#loading packages
library(pacman)
p_load(tidyverse, ggplot2, knitr, labelled, gtsummary, haven, table1)

here::i_am("Report.Rmd")
#reading in the data set
projectdata <- read.csv(file = here::here("data/f75_interim.csv"))

var_label(projectdata) <- list(
  agemons = "Age (months)",
  sex = "Sex assigned at birth",
  caregiver = "Primary Caregiver",
  bfeeding = "Current Breastfeeding Status",
  muac = "MUAC (cms) at baseline",
  muac1 = "MUAC (cms) at stabilization",
  muac2 = "MUAC (cms) at discharge/death/widthdrawl",
  arm = "Formula type"
)
```

```{r, table1, echo = FALSE}
table1 <- readRDS(
  here::here("alex/output/01_table1.rds"))
print(table1)
```

```{r, boxplots, echo = FALSE}
knitr::include_graphics(
  here::here("erika/output/02_muac_boxplot.png"))

knitr::include_graphics(
  here::here("erika/output/02_height_boxplot.png"))

knitr::include_graphics(
  here::here("erika/output/02_weight_boxplot.png"))
```

```{r, barchart, echo = FALSE}
knitr::include_graphics(
  here::here("erika/output/03_oedema_barchart.png"))
```

```{r, regression, echo = FALSE}
knitr::include_graphics(
  here::here("tina/output/04_reg_plot1.png"))
  
knitr::include_graphics(
  here::here("tina/output/05_reg_plot2.png"))
```

```{r, figure3, echo = FALSE}
figure3 <- readRDS(
  here::here("afia/output/07_bf_graph.rds"))
print(figure3)

figure4 <- readRDS(
  here::here("afia/output/09_treatment_graph.rds"))
print(figure4)
```

```{r, params_figure, echo = FALSE}

projectdata <- projectdata %>% 
mutate(newvardata = case_when(projectdata[[params$var_name]] < params$var_cutoff ~ "Less than cutoff",
                            projectdata[[params$var_name]] >= params$var_cutoff ~ "Greater than or equal to cutoff"
))
table(projectdata$newvardata, useNA = "always")

params_graph <- projectdata %>% filter(days_stable != 999) %>% 
  ggplot( aes(x= newvardata, y=days_stable)) +
  geom_boxplot() + 
  labs(title = paste("Box plot of", params$var_name, "above and below", params$var_cutoff), x = "", y = "Days to Stabilization")

params_graph

print(params_graph)
```

